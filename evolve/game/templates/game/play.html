{% extends "game/base.html" %}

{% block extrahead %}
    <script>
        $(function() {
            $( "#players" ).tabs().tabs('select', 1);
        });
    </script>
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}css/play.css"/>
{% endblock %}
{% block contents %}


<h1>Play Game</h1>

<div id="players">
    <ul>
        <li><a href="#player-info-{{player_in_game.left_player.pk}}">{{ player_in_game.left_player }}</a></li>
        <li class="current-player"><a href="#player-info-{{player_in_game.pk}}">{{ player_in_game }}</a></li>
        {% for p in player_in_game.all_right_players %}
            <li><a href="#player-info-{{p.pk}}">{{ p }}</a></li>
        {% endfor %}
    </ul>

    {% include "game/player_info.html" with player=player_in_game.left_player %}
    {% include "game/player_info.html" with player=player_in_game %}

    {% for p in player_in_game.all_right_players %}
        {% include "game/player_info.html" with player=p %}
    {% endfor %}
</div>


{% if player_in_game.can_play %}
    <h3>Next action</h3>

    <form action="" method="POST">
        <table>
            <tr><th>{{ form.option.label }}</th>
                <td>{{ form.option }}</td>
                <td><ul>{% for o in player_in_game.current_options.all %}<li>{{ o.building.cost }}</li>{% endfor %}</ul></td>
                <td><ul>{% for o in player_in_game.current_options.all %}<li>{{ o.building.effect }}</li>{% endfor %}</ul></td>
            </tr>
            {% if form.option.errors %}
            <tr><td colspan="3">{{ form.option.errors }}</td></tr>
            {% endif %}
            <tr><th>{{ form.action.label }}</th>
                <td>{{ form.action }}</td>
            </tr>
            {% if form.action.errors %}
            <tr><td colspan="3">{{ form.action.errors }}</td></tr>
            {% endif %}
            <tr><th>{{ form.payment.label }}</th>
                <td>{{ form.payment }}</td>
            </tr>
            {% if form.payment.errors %}
            <tr><td colspan="3">{{ form.payment.errors }}</td></tr>
            {% endif %}
            {% if form.errors %}
            <tr><td colspan="3">{{ form.non_field_errors }}</td></tr>
            {% endif %}
        </table>
        {% csrf_token %}
        <input type="submit">
    </form>

{% else %}
    <p class="error">You can't play now</p>
{% endif %}

<a href="{% url games %}">Cancel</a>

{% endblock %}

